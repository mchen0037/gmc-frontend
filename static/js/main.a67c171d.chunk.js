(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{167:function(t,e,n){"use strict";n.r(e);var a=n(0),s=n.n(a),i=n(19),r=n.n(i),o=(n(90),n(21)),l=n.n(o),c=n(27),u=n(10),h=n(11),d=n(14),p=n(12),m=n(13),b=n(7),f=(n(94),function(t){function e(){return Object(u.a)(this,e),Object(d.a)(this,Object(p.a)(e).apply(this,arguments))}return Object(m.a)(e,t),Object(h.a)(e,[{key:"render",value:function(){return s.a.createElement("div",null,this.props.user.display_name?s.a.createElement("div",null,this.props.user.display_name," is logged in."):s.a.createElement("div",null,"Please Sign in!"),s.a.createElement("button",{className:"btn btn-success btn-sm m-2",onClick:this.props.handleLogin},"Sign In with Spotify"))}}]),e}(a.Component)),g=n(173),k=n(168),y=function(t){function e(t){var n;return Object(u.a)(this,e),(n=Object(d.a)(this,Object(p.a)(e).call(this,t))).state={status:"Select a Playlist"},n}return Object(m.a)(e,t),Object(h.a)(e,[{key:"chosePlaylist",value:function(t){this.setState({status:t}),this.props.handleClick(t)}},{key:"render",value:function(){var t=this;return s.a.createElement("div",null,s.a.createElement("div",{className:"dropdown"},s.a.createElement(g.a,{title:this.state.status,id:"dropdown-size-small",className:"btn btn-primary btn-sm m-2"},this.props.playlists.map(function(e){return s.a.createElement(k.a,{key:e.id,onClick:function(){return t.chosePlaylist(e.name)}},e.name)}))))}}]),e}(a.Component),v=n(67),j=n(26),O=n.n(j),S=function(t){function e(t){var n;return Object(u.a)(this,e),(n=Object(d.a)(this,Object(p.a)(e).call(this,t))).state={good:"",bad:""},n.handleClickGood=n.handleClickGood.bind(Object(b.a)(Object(b.a)(n))),n.handleClickBad=n.handleClickBad.bind(Object(b.a)(Object(b.a)(n))),n.submitTrainingSelection=n.submitTrainingSelection.bind(Object(b.a)(Object(b.a)(n))),n}return Object(m.a)(e,t),Object(h.a)(e,[{key:"handleClickGood",value:function(t){this.setState({good:t})}},{key:"handleClickBad",value:function(t){this.setState({bad:t})}},{key:"submitTrainingSelection",value:function(){var t=Object(c.a)(l.a.mark(function t(){var e,n,a,s,i,r,o,c,u,h,d,p,m=this;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.props.playlists.filter(function(t){return t.name===m.state.good}),n=this.props.playlists.filter(function(t){return t.name===m.state.bad}),t.next=4,fetch("https://api.spotify.com/v1/playlists/"+e[0].id+"/tracks",{headers:{Authorization:"Bearer "+this.props.token}});case 4:return a=t.sent,t.next=7,a.json();case 7:return s=t.sent,i=s.items.map(function(t){return t.track.id}),t.next=11,fetch("https://api.spotify.com/v1/playlists/"+n[0].id+"/tracks",{headers:{Authorization:"Bearer "+this.props.token}});case 11:return r=t.sent,t.next=14,r.json();case 14:return o=t.sent,c=o.items.map(function(t){return t.track.id}),t.next=18,fetch("https://api.spotify.com/v1/audio-features/?ids="+i.toString(),{headers:{Authorization:"Bearer "+this.props.token}});case 18:return u=t.sent,t.next=21,u.json();case 21:return h=t.sent,t.next=24,fetch("https://api.spotify.com/v1/audio-features/?ids="+c.toString(),{headers:{Authorization:"Bearer "+this.props.token}});case 24:return d=t.sent,t.next=27,d.json();case 27:p=t.sent,O.a.post("https://gmc-backend.herokuapp.com/train",{good:h.audio_features,bad:p.audio_features,user:this.props.user}).then(function(t){}),this.props.trained();case 30:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"render",value:function(){return console.log("props: ",this.props),s.a.createElement("div",null,"Good Playlist:",s.a.createElement(y,{id:1,playlists:this.props.playlists,handleClick:this.handleClickGood}),"Bad Playlist:",s.a.createElement(y,{id:3,playlists:this.props.playlists,handleClick:this.handleClickBad}),this.state.good&&this.state.bad?s.a.createElement(v.a,{bsStyle:"primary",className:"btn btn-success btn-sm m-2",onClick:this.submitTrainingSelection},"Submit!"):s.a.createElement(v.a,{bsStyle:"default",className:"btn btn-default btn-sm m-2"},"Please select a playlist for each"))}}]),e}(a.Component),E=function(t){function e(t){var n;return Object(u.a)(this,e),(n=Object(d.a)(this,Object(p.a)(e).call(this,t))).state={models:[]},n}return Object(m.a)(e,t),Object(h.a)(e,[{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement(v.a,{bsStyle:"default",bsClass:"btn btn-primary btn-sm m-2",onClick:this.props.nowTesting},"Test A Song"),s.a.createElement(v.a,{bsStyle:"default",bsClass:"btn btn-danger btn-sm m-2",onClick:this.props.handleDelete},"Delete Model"))}}]),e}(a.Component),C=n(169),w=n(170),T=n(174),x=n(171),B=function(t){function e(t){var n;return Object(u.a)(this,e),(n=Object(d.a)(this,Object(p.a)(e).call(this,t))).state={value:""},n.handleChange=n.handleChange.bind(Object(b.a)(Object(b.a)(n))),n.handleButtonClick=n.handleButtonClick.bind(Object(b.a)(Object(b.a)(n))),n}return Object(m.a)(e,t),Object(h.a)(e,[{key:"handleChange",value:function(t){this.setState({value:t.target.value})}},{key:"handleButtonClick",value:function(){this.props.addSongs(this.state.value),this.setState({value:""})}},{key:"render",value:function(){return s.a.createElement("form",null,s.a.createElement(C.a,{controlId:"formBasicText"},s.a.createElement(w.a,null,"Testing New Songs!"),s.a.createElement(T.a,{type:"text",value:this.state.value,placeholder:"Enter a Spotify URI",onChange:this.handleChange}),s.a.createElement(v.a,{bsStyle:"default",className:"btn btn-success btn-sm m-2",onClick:this.handleButtonClick},"Submit"),s.a.createElement(T.a.Feedback,null),s.a.createElement(x.a,null,"Example: spotify:track:5HeKOKc4phmLn8e4I7EkzD")))}}]),e}(a.Component),N=n(172),A=function(t){function e(){return Object(u.a)(this,e),Object(d.a)(this,Object(p.a)(e).apply(this,arguments))}return Object(m.a)(e,t),Object(h.a)(e,[{key:"render",value:function(){var t=this;return console.log("Results props:",this.props),s.a.createElement(N.a,null,s.a.createElement("thead",null,s.a.createElement("tr",null,s.a.createElement("th",null,"URI"),s.a.createElement("th",null,"Song Name"),s.a.createElement("th",null,"Result"),s.a.createElement("th",null))),s.a.createElement("tbody",null,this.props.songs.map(function(e){return s.a.createElement("tr",null,s.a.createElement("td",null,e.key),s.a.createElement("td",null,e.name?e.name:"Song Name"),s.a.createElement("td",null,e.result?e.result:"Result"),s.a.createElement("td",null,s.a.createElement(v.a,{bsStyle:"default",className:"btn btn-danger btn-sm m-2",onClick:function(){return t.props.handleDeleteSong(e.key)}},"X")))})))}}]),e}(a.Component),z=function(t){function e(t){var n;return Object(u.a)(this,e),(n=Object(d.a)(this,Object(p.a)(e).call(this,t))).state={songs:[]},n.addSongToList=n.addSongToList.bind(Object(b.a)(Object(b.a)(n))),n.removeSong=n.removeSong.bind(Object(b.a)(Object(b.a)(n))),n.testSongs=n.testSongs.bind(Object(b.a)(Object(b.a)(n))),n}return Object(m.a)(e,t),Object(h.a)(e,[{key:"addSongToList",value:function(t){var e=this.state.songs;e.push({key:t}),this.setState({songs:e})}},{key:"removeSong",value:function(t){var e=this.state.songs.filter(function(e){return e.key!==t});this.setState({songs:e})}},{key:"testSongs",value:function(){var t=Object(c.a)(l.a.mark(function t(){var e,n,a,s,i,r,o,c=this;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.state.songs.map(function(t){return t.key.substring(14)}),console.log(e),t.next=4,fetch("https://api.spotify.com/v1/audio-features/?ids="+e.toString(),{headers:{Authorization:"Bearer "+this.props.token}});case 4:return n=t.sent,t.next=7,n.json();case 7:return a=t.sent,t.next=10,fetch("https://api.spotify.com/v1/tracks/?ids="+e.toString(),{headers:{Authorization:"Bearer "+this.props.token}});case 10:return s=t.sent,t.next=13,s.json();case 13:i=t.sent,r=i.tracks.map(function(t){return t.name}),console.log("names:",r),o=-1,O.a.post("https://gmc-backend.herokuapp.compredict/"+this.props.user,{test:a.audio_features}).then(function(t){var e=t.data.results.map(function(t){return o++,{key:c.state.songs[o].key,name:r[o],result:t}});console.log(e),c.setState({songs:e})}),console.log("testing songs!!");case 19:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"render",value:function(){var t=this;return console.log(this.state),s.a.createElement("div",null,s.a.createElement(v.a,{bsStyle:"default",className:"btn btn-danger btn-sm m-2",onClick:this.props.stopTesting},"Back"),s.a.createElement(B,{addSongs:function(e){return t.addSongToList(e)}}),this.state.songs[0]&&s.a.createElement("div",null,s.a.createElement(A,{songs:this.state.songs,handleDeleteSong:function(e){return t.removeSong(e)}}),s.a.createElement(v.a,{bsStyle:"default",bsClass:"btn btn-primary btn-sm m-2",onClick:this.testSongs},"Test!")))}}]),e}(a.Component),P=n(84),D=n.n(P),L=function(t){function e(t){var n;return Object(u.a)(this,e),(n=Object(d.a)(this,Object(p.a)(e).call(this,t))).state={user:{},playlists:[],trained:!1,testing:!1,token:""},n.loginToSpotify=n.loginToSpotify.bind(Object(b.a)(Object(b.a)(n))),n.nowTrained=n.nowTrained.bind(Object(b.a)(Object(b.a)(n))),n.deleteModel=n.deleteModel.bind(Object(b.a)(Object(b.a)(n))),n.startTesting=n.startTesting.bind(Object(b.a)(Object(b.a)(n))),n.stopTesting=n.stopTesting.bind(Object(b.a)(Object(b.a)(n))),n}return Object(m.a)(e,t),Object(h.a)(e,[{key:"loginToSpotify",value:function(){window.location="https://gmc-oauth.herokuapp.com/login"}},{key:"nowTrained",value:function(){this.setState({trained:!0})}},{key:"deleteModel",value:function(){O.a.get("https://gmc-backend.herokuapp.com/delete/"+this.state.user.id).then(function(t){}),this.setState({trained:!1})}},{key:"startTesting",value:function(){this.setState({testing:!0})}},{key:"stopTesting",value:function(){this.setState({testing:!1})}},{key:"componentDidMount",value:function(){var t=Object(c.a)(l.a.mark(function t(){var e,n,a,s,i,r=this;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=D.a.parse(window.location.search),n=e.access_token,this.setState({token:n}),fetch("https://api.spotify.com/v1/me",{headers:{Authorization:"Bearer "+n}}).then(function(t){return t.json()}).then(function(t){r.setState({user:t}),O.a.get("https://gmc-backend.herokuapp.com/models/"+t.id).then(function(t){t.data.result&&r.nowTrained()})}),t.next=6,fetch("https://api.spotify.com/v1/me/playlists",{headers:{Authorization:"Bearer "+n}});case 6:return a=t.sent,t.next=9,a.json();case 9:s=t.sent,i=s.items,this.setState({playlists:i});case 12:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"render",value:function(){return s.a.createElement("div",{className:"App"},s.a.createElement("header",{className:"App-header"},this.state.playlists?this.state.trained?s.a.createElement("div",null,this.state.testing?s.a.createElement(z,{stopTesting:this.stopTesting,token:this.state.token,user:this.state.user.id}):s.a.createElement("div",null,"Hey ",this.state.user.id,"! Your model is trained!",s.a.createElement(E,{handleDelete:this.deleteModel,nowTesting:this.startTesting}))):s.a.createElement("div",null,"Hi ",this.state.user.display_name,"! Please train a model.",s.a.createElement(S,{playlists:this.state.playlists,trained:this.nowTrained,token:this.state.token,user:this.state.user.id})):s.a.createElement(f,{handleLogin:this.loginToSpotify,user:this.state.user})))}}]),e}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(165);r.a.render(s.a.createElement(L,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})},85:function(t,e,n){t.exports=n(167)},90:function(t,e,n){},94:function(t,e,n){}},[[85,2,1]]]);
//# sourceMappingURL=main.a67c171d.chunk.js.map